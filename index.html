<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatterboxWeb - In-browser Voice Cloning</title>
    <link rel="stylesheet" href="./styles/main.css">
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo">
                <div class="logo-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                        <path d="M12 14C13.66 14 15 12.66 15 11V5C15 3.34 13.66 2 12 2C10.34 2 9 3.34 9 5V11C9 12.66 10.34 14 12 14Z" fill="white"/>
                        <path d="M17 11C17 13.76 14.76 16 12 16C9.24 16 7 13.76 7 11H5C5 14.53 7.61 17.43 11 17.92V21H13V17.92C16.39 17.43 19 14.53 19 11H17Z" fill="white"/>
                    </svg>
                </div>
                <span class="logo-text">Chatterbox<span class="logo-web">Web</span></span>
            </div>

            <nav class="nav-menu">
                <button class="nav-item active" data-page="home">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M3 10L10 3L17 10V17H12V13H8V17H3V10Z" fill="currentColor"/>
                    </svg>
                    <span>Home</span>
                </button>
                <button class="nav-item" data-page="library">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <rect x="3" y="3" width="4" height="4" fill="currentColor"/>
                        <rect x="8" y="3" width="4" height="4" fill="currentColor"/>
                        <rect x="13" y="3" width="4" height="4" fill="currentColor"/>
                        <rect x="3" y="8" width="4" height="4" fill="currentColor"/>
                        <rect x="8" y="8" width="4" height="4" fill="currentColor"/>
                        <rect x="13" y="8" width="4" height="4" fill="currentColor"/>
                    </svg>
                    <span>Voice Library</span>
                </button>
                <button class="nav-item" data-page="history">
                    <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                        <path d="M10 18C14.418 18 18 14.418 18 10C18 5.582 14.418 2 10 2C5.582 2 2 5.582 2 10C2 14.418 5.582 18 10 18Z" stroke="currentColor" stroke-width="2" fill="none"/>
                        <path d="M10 6V10L13 13" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                    <span>History</span>
                </button>
            </nav>

            <div class="sidebar-footer">
                <div class="powered-by">
                    <p>Powered by Transformers.js</p>
                    <p class="powered-desc">Everything runs 100% locally in your browser on WebGPU.</p>
                </div>
                <div class="model-progress" id="model-progress" aria-live="polite">
                    <div class="model-progress-label">Model Downloads</div>
                    <div class="model-progress-status" id="model-progress-text">Idle</div>
                    <div class="model-progress-bar">
                        <div class="model-progress-fill" id="model-progress-fill"></div>
                    </div>
                </div>
                <div class="footer-buttons">
                    <button class="footer-btn" id="view-model-btn">View Model</button>
                    <button class="footer-btn" id="source-code-btn">Source Code</button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Home Page -->
            <div class="page active" id="home-page">
                <header class="page-header">
                    <h1>In-browser voice cloning with Chatterbox Turbo</h1>
                    <p class="page-subtitle">Select or clone a voice, write your script, and generate premium-quality audio.</p>
                </header>

                <div class="generation-container">
                    <!-- Voice Selection -->
                    <section class="card">
                        <div class="card-header">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M8 10C9.105 10 10 9.105 10 8V4C10 2.895 9.105 2 8 2C6.895 2 6 2.895 6 4V8C6 9.105 6.895 10 8 10Z" fill="currentColor"/>
                            </svg>
                            <h2>Voice</h2>
                        </div>
                        <div class="voice-selector-container">
                            <select class="voice-selector" id="voice-selector">
                                <option value="ethan">Ethan</option>
                            </select>
                            <button class="btn btn-primary" id="create-voice-btn">Create new voice</button>
                        </div>
                    </section>

                    <!-- Text Input -->
                    <section class="card">
                        <div class="card-header">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <rect x="2" y="4" width="12" height="2" fill="currentColor"/>
                                <rect x="2" y="8" width="8" height="2" fill="currentColor"/>
                            </svg>
                            <h2>Text</h2>
                        </div>
                        <div class="text-input-wrapper">
                            <div
                                class="text-input-highlights"
                                id="text-input-highlights"
                                aria-hidden="true"></div>
                            <textarea
                                class="text-input"
                                id="text-input"
                                placeholder="Enter your text here..."
                                rows="6">Oh, that's hilarious! [chuckle] Um anyway, how are you doing today?</textarea>
                        </div>

                        <div class="emotion-tags">
                            <h3>EMOTION TAGS</h3>
                            <div class="tags-container">
                                <button class="tag-btn">angry</button>
                                <button class="tag-btn">fear</button>
                                <button class="tag-btn">surprised</button>
                                <button class="tag-btn">whispering</button>
                                <button class="tag-btn">advertisement</button>
                                <button class="tag-btn">dramatic</button>
                                <button class="tag-btn">narration</button>
                                <button class="tag-btn">crying</button>
                                <button class="tag-btn">happy</button>
                                <button class="tag-btn">sarcastic</button>
                                <button class="tag-btn">clear throat</button>
                                <button class="tag-btn">sigh</button>
                                <button class="tag-btn">shush</button>
                                <button class="tag-btn">cough</button>
                                <button class="tag-btn">groan</button>
                                <button class="tag-btn">sniff</button>
                                <button class="tag-btn">gasp</button>
                                <button class="tag-btn">chuckle</button>
                                <button class="tag-btn">laugh</button>
                            </div>
                        </div>
                    </section>

                    <!-- Style Controls -->
                    <section class="card">
                        <div class="card-header">
                            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                                <path d="M12 2L14 8L12 14L6 12L2 8L6 4L12 2Z" fill="currentColor"/>
                            </svg>
                            <h2>Style</h2>
                        </div>

                        <div class="controls-row">
                            <div class="control-group">
                                <label class="control-label">
                                    <span>Temperature</span>
                                    <span class="control-value" id="temp-value">0.20</span>
                                </label>
                                <p class="control-desc">Increase randomness and variation.</p>
                                <input type="range" class="slider" id="temperature-slider" min="0" max="2" step="0.01" value="0.20">
                            </div>

                            <div class="control-group">
                                <label class="control-label">
                                    <span>Repetition Penalty</span>
                                    <span class="control-value" id="rep-value">1.20</span>
                                </label>
                                <p class="control-desc">Penalize repeated speech patterns to enhance diversity.</p>
                                <input type="range" class="slider" id="repetition-slider" min="1" max="2" step="0.01" value="1.20">
                            </div>
                        </div>

                        <button class="btn btn-generate" id="generate-btn">
                            <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                <path d="M10 2L13 8L10 14L4 11L2 6L6 4L10 2Z" fill="currentColor"/>
                            </svg>
                            Generate
                        </button>
                    </section>

                    <!-- Output Section -->
                    <section class="card output-section" id="output-section" style="display: none;">
                        <div class="waveform" id="waveform"></div>
                        <div class="audio-player-container">
                            <audio controls class="audio-player" id="audio-player"></audio>
                            <button class="btn btn-icon" id="download-btn" title="Download">
                                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                                    <path d="M10 12L6 8H8V4H12V8H14L10 12Z" fill="currentColor"/>
                                    <path d="M16 14V16H4V14H2V16C2 17.1 2.9 18 4 18H16C17.1 18 18 17.1 18 16V14H16Z" fill="currentColor"/>
                                </svg>
                            </button>
                        </div>
                    </section>

                    <!-- Loading State -->
                    <section class="card loading-section" id="loading-section" style="display: none;">
                        <div class="loading-spinner"></div>
                        <p class="loading-text">Generating audio...</p>
                        <p class="loading-subtext" id="loading-status">Initializing models...</p>
                    </section>
                </div>
            </div>

            <!-- Voice Library Page -->
            <div class="page" id="library-page">
                <header class="page-header">
                    <h1>Voice Library</h1>
                    <button class="btn btn-primary" id="add-voice-btn">+ Add Voice</button>
                </header>

                <div class="search-container">
                    <input type="text" class="search-input" id="voice-search" placeholder="Search voices...">
                    <span class="voice-count" id="voice-count">0 voices</span>
                </div>

                <div class="voice-grid" id="voice-grid">
                    <!-- Voice cards will be dynamically added here -->
                </div>
            </div>

            <!-- History Page -->
            <div class="page" id="history-page">
                <header class="page-header">
                    <h1>History</h1>
                </header>

                <div class="history-list" id="history-list">
                    <!-- History entries will be dynamically added here -->
                </div>
            </div>
        </main>
    </div>

    <!-- Voice Upload Modal -->
    <div class="modal" id="voice-upload-modal">
        <div class="modal-content">
            <h2 class="modal-title">Add New Voice</h2>

            <button class="upload-option" id="upload-file-btn">
                <span>Upload from File</span>
            </button>

            <input type="file" id="file-input" accept="audio/*" style="display: none;">

            <p class="modal-divider">or capture a new sample</p>

            <button class="upload-option upload-option-primary" id="record-btn">
                <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
                    <path d="M10 13C11.66 13 13 11.66 13 10V5C13 3.34 11.66 2 10 2C8.34 2 7 3.34 7 5V10C7 11.66 8.34 13 10 13Z" fill="white"/>
                    <path d="M15 10C15 12.76 12.76 15 10 15C7.24 15 5 12.76 5 10H3C3 13.53 5.61 16.43 9 16.92V20H11V16.92C14.39 16.43 17 13.53 17 10H15Z" fill="white"/>
                </svg>
                <span>Record with Microphone (1â€“60s)</span>
            </button>

            <!-- Recording State -->
            <div class="recording-state" id="recording-state" style="display: none;">
                <div class="recording-indicator">
                    <div class="recording-dot"></div>
                    <span>Recording... <span id="recording-time">0:00</span></span>
                </div>
                <button class="btn btn-danger" id="stop-recording-btn">Stop Recording</button>
            </div>

            <!-- Preview State -->
            <div class="preview-state" id="preview-state" style="display: none;">
                <h3 class="preview-title">Preview & Save</h3>
                <audio controls class="preview-audio" id="preview-audio"></audio>

                <div class="form-group">
                    <label for="voice-name-input">VOICE NAME</label>
                    <input type="text" class="form-input" id="voice-name-input" placeholder="Enter voice name">
                </div>

                <div class="form-group">
                    <label for="voice-desc-input">DESCRIPTION</label>
                    <textarea class="form-input" id="voice-desc-input" placeholder="Describe when this voice should be used." rows="3"></textarea>
                </div>

                <p class="sample-ready">Sample ready to upload.</p>

                <div class="preview-actions">
                    <button class="btn btn-secondary" id="re-record-btn" type="button">
                        Re-record sample
                    </button>
                </div>

                <div class="modal-buttons">
                    <button class="btn btn-secondary" id="cancel-voice-btn">Cancel</button>
                    <button class="btn btn-primary" id="save-voice-btn">Save Voice</button>
                </div>
            </div>

            <button class="modal-close" id="close-modal-btn">Close</button>
        </div>
    </div>

    <script type="module" src="./js/main.js"></script>
</body>
</html>
